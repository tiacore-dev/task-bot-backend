{
  "upgrade": [
    "CREATE TABLE IF NOT EXISTS \"taskplatform\" (\n    \"platform_id\" UUID NOT NULL PRIMARY KEY,\n    \"name\" VARCHAR(100) NOT NULL UNIQUE,\n    \"created_at\" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP\n);\nCREATE TABLE IF NOT EXISTS \"taskrequirementtype\" (\n    \"req_type_id\" VARCHAR(50) NOT NULL PRIMARY KEY,\n    \"name\" VARCHAR(255) NOT NULL UNIQUE,\n    \"created_at\" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP\n);\nCREATE TABLE IF NOT EXISTS \"taskstatus\" (\n    \"status_id\" VARCHAR(50) NOT NULL PRIMARY KEY,\n    \"name\" VARCHAR(255) NOT NULL UNIQUE,\n    \"created_at\" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP\n);\nCREATE TABLE IF NOT EXISTS \"tasktype\" (\n    \"task_type_id\" VARCHAR(50) NOT NULL PRIMARY KEY,\n    \"name\" VARCHAR(255) NOT NULL UNIQUE,\n    \"created_at\" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP\n);\nCREATE TABLE IF NOT EXISTS \"userrole\" (\n    \"role_id\" VARCHAR(50) NOT NULL PRIMARY KEY,\n    \"name\" VARCHAR(50) NOT NULL UNIQUE,\n    \"created_at\" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP\n);\nCREATE TABLE IF NOT EXISTS \"user\" (\n    \"user_id\" UUID NOT NULL PRIMARY KEY,\n    \"telegram_id\" BIGINT NOT NULL UNIQUE,\n    \"username\" VARCHAR(255),\n    \"balance\" DECIMAL(10,2) NOT NULL DEFAULT 0,\n    \"created_at\" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    \"referrer_id\" UUID REFERENCES \"user\" (\"user_id\") ON DELETE CASCADE,\n    \"role_id\" VARCHAR(50) NOT NULL REFERENCES \"userrole\" (\"role_id\") ON DELETE CASCADE\n);\nCREATE TABLE IF NOT EXISTS \"task\" (\n    \"task_id\" UUID NOT NULL PRIMARY KEY,\n    \"description\" TEXT NOT NULL,\n    \"reward\" DECIMAL(10,2) NOT NULL,\n    \"verification_type\" VARCHAR(50) NOT NULL,\n    \"created_at\" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    \"creator_id\" UUID NOT NULL REFERENCES \"user\" (\"user_id\") ON DELETE CASCADE,\n    \"platform_id\" UUID NOT NULL REFERENCES \"taskplatform\" (\"platform_id\") ON DELETE CASCADE,\n    \"status_id\" VARCHAR(50) NOT NULL REFERENCES \"taskstatus\" (\"status_id\") ON DELETE CASCADE,\n    \"task_type_id\" VARCHAR(50) NOT NULL REFERENCES \"tasktype\" (\"task_type_id\") ON DELETE CASCADE\n);\nCREATE TABLE IF NOT EXISTS \"transaction\" (\n    \"transaction_id\" UUID NOT NULL PRIMARY KEY,\n    \"amount\" DECIMAL(10,2) NOT NULL,\n    \"transaction_type\" VARCHAR(50) NOT NULL,\n    \"created_at\" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    \"task_id\" UUID REFERENCES \"task\" (\"task_id\") ON DELETE CASCADE,\n    \"user_id\" UUID NOT NULL REFERENCES \"user\" (\"user_id\") ON DELETE CASCADE\n);\nCREATE TABLE IF NOT EXISTS \"useraccount\" (\n    \"id\" SERIAL NOT NULL PRIMARY KEY,\n    \"account_id\" VARCHAR(255) NOT NULL UNIQUE,\n    \"platform\" VARCHAR(100) NOT NULL,\n    \"account_name\" VARCHAR(255) NOT NULL,\n    \"created_at\" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    \"user_id\" UUID NOT NULL REFERENCES \"user\" (\"user_id\") ON DELETE CASCADE\n);\nCREATE TABLE IF NOT EXISTS \"taskassignment\" (\n    \"assignment_id\" UUID NOT NULL PRIMARY KEY,\n    \"submitted_at\" TIMESTAMPTZ,\n    \"status\" VARCHAR(50) NOT NULL DEFAULT 'in_progress',\n    \"assigned_profile_id\" INT NOT NULL REFERENCES \"useraccount\" (\"id\") ON DELETE CASCADE,\n    \"task_id\" UUID NOT NULL REFERENCES \"task\" (\"task_id\") ON DELETE CASCADE,\n    \"user_id\" UUID NOT NULL REFERENCES \"user\" (\"user_id\") ON DELETE CASCADE\n);\nCREATE TABLE IF NOT EXISTS \"taskverification\" (\n    \"verification_id\" UUID NOT NULL PRIMARY KEY,\n    \"check_date\" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    \"status\" VARCHAR(50) NOT NULL DEFAULT 'pending',\n    \"details\" TEXT,\n    \"task_assignment_id\" UUID NOT NULL REFERENCES \"taskassignment\" (\"assignment_id\") ON DELETE CASCADE\n);\nCREATE TABLE IF NOT EXISTS \"useractivitylog\" (\n    \"log_id\" UUID NOT NULL PRIMARY KEY,\n    \"action\" VARCHAR(255) NOT NULL,\n    \"timestamp\" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    \"user_id\" UUID NOT NULL REFERENCES \"user\" (\"user_id\") ON DELETE CASCADE\n);\nCREATE TABLE IF NOT EXISTS \"aerich\" (\n    \"id\" SERIAL NOT NULL PRIMARY KEY,\n    \"version\" VARCHAR(255) NOT NULL,\n    \"app\" VARCHAR(20) NOT NULL\n);"
  ]
}